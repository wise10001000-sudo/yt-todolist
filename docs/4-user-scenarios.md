# 사용자 시나리오 문서

> **yt-todolist** - 사용자 인증 기반 할일 관리 애플리케이션

---

## 문서 정보

| 항목          | 내용       |
| ------------- | ---------- |
| **문서 버전** | 1.0        |
| **작성일**    | 2025-11-25 |
| **작성자**    | 개발팀     |
| **상태**      | Final      |

---

## 목차

1. [페르소나 정의](#1-페르소나-정의)
2. [사용자 여정 맵](#2-사용자-여정-맵)
3. [핵심 시나리오](#3-핵심-시나리오)
4. [예외 시나리오](#4-예외-시나리오)
5. [사용자 스토리](#5-사용자-스토리)

---

## 1. 페르소나 정의

### 페르소나 1: 대학생 김민수

**기본 정보:**
- 나이: 23세
- 직업: 대학생 (컴퓨터공학과 3학년)
- 거주지: 서울
- 기술 수준: 높음

**특징:**
- 과제, 프로젝트, 동아리 활동 등 다양한 일정 관리 필요
- 마감일이 많아 일정 추적이 중요
- 모바일과 데스크톱을 모두 사용
- 실수로 삭제한 항목을 복구하고 싶어함

**목표:**
- 과제 마감일을 놓치지 않기
- 여러 프로젝트를 체계적으로 관리
- 빠르고 간편한 할일 추가/수정

**페인 포인트:**
- 기존 메모앱은 일정 관리가 약함
- 복잡한 앱은 사용하기 귀찮음
- 실수로 삭제한 데이터 복구 어려움

---

### 페르소나 2: 직장인 박지영

**기본 정보:**
- 나이: 32세
- 직업: 마케팅 매니저
- 거주지: 경기도 성남
- 기술 수준: 중간

**특징:**
- 업무와 개인 일정을 함께 관리
- 주간/월간 계획을 세우는 습관
- 주로 데스크톱에서 작업, 외근 시 모바일 사용
- 데이터 보안과 개인정보 보호에 민감

**목표:**
- 업무 일정을 체계적으로 관리
- 공휴일과 업무 일정을 함께 확인
- 안정적이고 신뢰할 수 있는 서비스

**페인 포인트:**
- 공휴일을 수동으로 입력하는 것이 번거로움
- 여러 앱을 사용하면 데이터가 분산됨
- 중요한 할일을 실수로 삭제할까 걱정

---

### 페르소나 3: 프리랜서 최현우

**기본 정보:**
- 나이: 28세
- 직업: 프리랜서 디자이너
- 거주지: 부산
- 기술 수준: 중상

**특징:**
- 여러 프로젝트를 동시에 진행
- 클라이언트별 마감일 관리 중요
- 프로젝트 시작일과 종료일을 명확히 추적
- 재택근무로 자기주도적 일정 관리 필수

**목표:**
- 프로젝트별 마감일 추적
- 시작일과 종료일로 프로젝트 기간 파악
- 완료된 프로젝트 기록 유지

**페인 포인트:**
- 프로젝트가 많아 마감일 관리가 복잡
- 할일 앱이 너무 간단하거나 너무 복잡함
- 과거 프로젝트 기록을 찾기 어려움

---

## 2. 사용자 여정 맵

### 2.1 전체 사용자 여정

```
발견 → 가입 → 온보딩 → 첫 할일 추가 → 일상적 사용 → 고급 기능 활용
```

#### 단계별 여정

| 단계 | 사용자 행동 | 감정 | 터치포인트 | 기회 |
|------|-------------|------|------------|------|
| **발견** | 할일 관리 앱 검색 | 필요성 인식 | 검색 엔진, 추천 | 명확한 가치 제안 |
| **가입** | 이메일로 회원가입 | 기대감, 약간의 귀찮음 | 회원가입 페이지 | 간편한 가입 절차 |
| **온보딩** | 서비스 둘러보기 | 호기심 | 메인 대시보드 | 직관적인 UI |
| **첫 할일 추가** | 첫 할일 작성 | 성취감 | 할일 추가 모달 | 쉬운 입력 폼 |
| **일상적 사용** | 할일 조회, 추가, 완료 | 만족감, 습관 형성 | 모든 기능 | 빠른 성능 |
| **고급 기능** | 휴지통, 공휴일 확인 | 신뢰감 | 휴지통, 캘린더 | 안정성과 신뢰성 |

---

## 3. 핵심 시나리오

### 시나리오 1: 첫 사용자 - 회원가입부터 첫 할일 추가까지

**페르소나:** 김민수 (대학생)

**상황:**
김민수는 과제 마감일을 놓친 경험이 있어 체계적인 할일 관리가 필요하다고 느꼈다. 친구의 추천으로 yt-todolist를 알게 되었다.

**시나리오 흐름:**

#### Step 1: 서비스 접속 및 회원가입

1. **행동**: 웹 브라우저에서 https://yt-todolist.com 접속
2. **화면**: 로그인 화면 표시 + "회원가입" 링크
3. **행동**: "회원가입" 링크 클릭
4. **화면**: 회원가입 페이지 표시
5. **행동**: 정보 입력
   - 이메일: `minsu.kim@student.ac.kr`
   - 비밀번호: `Student123!`
   - 사용자명: `김민수`
6. **행동**: "회원가입" 버튼 클릭
7. **시스템 처리**:
   - 입력 검증 (이메일 형식, 비밀번호 강도, 사용자명 길이)
   - 이메일 중복 확인
   - 비밀번호 bcrypt 해싱
   - 데이터베이스에 사용자 저장
8. **결과**: 성공 메시지 표시 → 로그인 페이지로 리다이렉트

**예상 소요 시간:** 1분

#### Step 2: 로그인

1. **행동**: 로그인 페이지에서 정보 입력
   - 이메일: `minsu.kim@student.ac.kr`
   - 비밀번호: `Student123!`
2. **행동**: "로그인" 버튼 클릭
3. **시스템 처리**:
   - 이메일로 사용자 조회
   - 비밀번호 검증 (bcrypt compare)
   - JWT 토큰 생성 (Access Token + Refresh Token)
   - Refresh Token 데이터베이스에 저장
4. **결과**:
   - 토큰을 클라이언트에 반환
   - 메인 대시보드로 리다이렉트

**예상 소요 시간:** 10초

#### Step 3: 첫 화면 경험

1. **화면**: 메인 대시보드 표시
   - 헤더: "yt-todolist" 로고, "김민수" 사용자명, 로그아웃 버튼
   - 메인 영역: 빈 상태 화면
     - 일러스트레이션
     - "아직 할일이 없습니다. 첫 할일을 추가해보세요!"
     - "할일 추가" 버튼 (강조 표시)
   - 사이드바: "할일 목록", "휴지통" 메뉴
2. **감정**: 깔끔하고 직관적인 UI에 만족

**예상 소요 시간:** 5초

#### Step 4: 첫 할일 추가

1. **행동**: "할일 추가" 버튼 클릭
2. **화면**: 할일 추가 모달 표시
3. **행동**: 정보 입력
   - 제목: `데이터베이스 과제 제출`
   - 내용: `ERD 설계 및 SQL 쿼리 작성`
   - 시작일: `2025-11-25 09:00`
   - 종료일: `2025-11-30 23:59`
4. **행동**: "저장" 버튼 클릭
5. **시스템 처리**:
   - 입력 검증 (제목 필수, 날짜 순서)
   - Authorization 헤더에서 사용자 확인
   - 데이터베이스에 할일 저장
6. **결과**:
   - 성공 토스트: "할일이 추가되었습니다"
   - 모달 닫힘
   - 할일 목록에 새 항목 표시

**예상 소요 시간:** 30초

#### Step 5: 결과 확인

1. **화면**: 메인 대시보드
   - 할일 카드 표시:
     ```
     ┌─────────────────────────────────────┐
     │ 데이터베이스 과제 제출               │
     │ ERD 설계 및 SQL 쿼리 작성           │
     │ 📅 2025-11-25 09:00 ~ 2025-11-30 23:59 │
     │ [수정] [삭제]                        │
     └─────────────────────────────────────┘
     ```
2. **감정**: 성취감, 만족감

**전체 소요 시간:** 약 2분

---

### 시나리오 2: 일상적 사용 - 할일 관리

**페르소나:** 박지영 (직장인)

**상황:**
박지영은 출근 후 오늘의 업무 일정을 확인하고, 새로운 업무를 추가한다. 점심시간에는 완료된 업무를 처리하고, 퇴근 전 내일 일정을 체크한다.

#### Part 1: 오전 - 출근 후 일정 확인

**시간:** 09:00

1. **행동**: 회사 컴퓨터에서 yt-todolist 접속
2. **시스템**:
   - 로컬 스토리지의 Refresh Token 확인
   - Access Token 만료 확인
   - 자동으로 토큰 갱신 (Refresh Token → 새 Access Token)
3. **화면**: 메인 대시보드 표시
   - 오늘 할일 3개 표시:
     ```
     1. 월간 마케팅 보고서 작성 (오늘 마감)
     2. 광고 캠페인 예산 검토 (내일 마감)
     3. 팀 회의 준비 (오늘 14:00)
     ```
   - 공휴일 표시: "크리스마스 (12월 25일)"
4. **행동**: 각 할일의 상세 내용 확인
5. **감정**: 오늘 해야 할 일이 명확해서 안심

**소요 시간:** 2분

#### Part 2: 오전 중 - 긴급 업무 추가

**시간:** 10:30

1. **상황**: 팀장으로부터 긴급 업무 요청
2. **행동**: "할일 추가" 버튼 클릭 (단축키 Ctrl+N 또는 Cmd+N)
3. **화면**: 할일 추가 모달
4. **행동**: 빠르게 입력
   - 제목: `긴급: 경쟁사 분석 보고서`
   - 내용: `A사, B사 최근 캠페인 분석`
   - 종료일: `2025-11-25 18:00` (오늘 퇴근 전)
5. **행동**: Enter 키로 빠른 저장
6. **결과**: 할일 목록 최상단에 추가 (종료일 임박 순)

**소요 시간:** 20초

#### Part 3: 점심시간 - 완료된 업무 처리

**시간:** 12:30

1. **행동**: 완료된 "팀 회의 준비" 할일 선택
2. **행동**: "삭제" 버튼 클릭
3. **화면**: 확인 없이 즉시 휴지통으로 이동
4. **결과**:
   - 성공 토스트: "할일이 휴지통으로 이동되었습니다"
   - 할일 목록에서 제거
   - 휴지통 메뉴에 뱃지 숫자 증가 (1)
5. **감정**: 완료 처리가 간편해서 만족

**소요 시간:** 5초

#### Part 4: 오후 - 할일 수정

**시간:** 15:00

1. **상황**: 마감일이 하루 연장됨
2. **행동**: "월간 마케팅 보고서 작성" 할일의 "수정" 버튼 클릭
3. **화면**: 할일 수정 모달 (기존 데이터 로드됨)
4. **행동**: 종료일만 수정
   - 기존: `2025-11-25 18:00`
   - 변경: `2025-11-26 18:00`
5. **행동**: "저장" 버튼 클릭
6. **시스템 처리**:
   - 날짜 유효성 검증
   - updated_at 자동 갱신
7. **결과**:
   - 성공 토스트: "할일이 수정되었습니다"
   - 할일 카드 업데이트

**소요 시간:** 15초

#### Part 5: 퇴근 전 - 내일 일정 확인

**시간:** 17:50

1. **행동**: 할일 목록에서 날짜 필터 변경: "오늘" → "이번 주"
2. **화면**:
   - 오늘 할일 2개 (1개 완료로 휴지통 이동)
   - 내일 할일 1개
   - 모레 할일 1개
   - 공휴일 정보 통합 표시
3. **행동**: 내일 할일 확인 후 만족
4. **행동**: 로그아웃 (선택)
   - 또는 그냥 브라우저 닫기 (토큰은 자동 관리)

**소요 시간:** 1분

**전체 하루 사용 시간:** 약 5분

---

### 시나리오 3: 휴지통 활용 - 실수 복구

**페르소나:** 김민수 (대학생)

**상황:**
김민수는 완료된 할일을 정리하다가 실수로 아직 완료하지 않은 중요한 과제를 삭제했다. 곧바로 실수를 깨닫고 복구를 시도한다.

#### Step 1: 실수로 할일 삭제

**시간:** 20:30

1. **행동**: 할일 목록에서 여러 완료된 할일 삭제 중
2. **행동**: "알고리즘 과제 제출" 할일의 "삭제" 버튼 실수로 클릭
3. **시스템 처리**:
   - status를 'active'에서 'trash'로 변경
   - deleted_at에 현재 시간 기록
   - 할일 목록에서 숨김
4. **결과**: 할일이 목록에서 사라짐
5. **감정**: 당황, 걱정

**소요 시간:** 1초

#### Step 2: 휴지통 접근

**시간:** 20:30 (즉시)

1. **행동**: 왼쪽 사이드바의 "휴지통" 메뉴 클릭
2. **화면**: 휴지통 페이지 표시
   - 삭제된 할일 목록 (삭제일시 순)
   ```
   ┌─────────────────────────────────────┐
   │ 알고리즘 과제 제출                   │
   │ 삭제일시: 2025-11-25 20:30         │
   │ [복원] [영구 삭제]                  │
   └─────────────────────────────────────┘
   ┌─────────────────────────────────────┐
   │ 영어 발표 준비                       │
   │ 삭제일시: 2025-11-25 18:15         │
   │ [복원] [영구 삭제]                  │
   └─────────────────────────────────────┘
   ```
3. **감정**: 안도감 (복구 가능하다는 것을 확인)

**소요 시간:** 2초

#### Step 3: 할일 복원

**시간:** 20:30

1. **행동**: "알고리즘 과제 제출"의 "복원" 버튼 클릭
2. **시스템 처리**:
   - status를 'trash'에서 'active'로 변경
   - deleted_at를 NULL로 설정
   - updated_at 갱신
3. **결과**:
   - 성공 토스트: "할일이 복원되었습니다"
   - 휴지통 목록에서 제거
4. **행동**: "할일 목록" 메뉴로 복귀
5. **화면**: 복원된 할일이 목록에 다시 표시됨
6. **감정**: 안도감, 시스템에 대한 신뢰 증가

**소요 시간:** 5초

**전체 소요 시간:** 약 10초 (문제 발견부터 해결까지)

---

### 시나리오 4: 휴지통 정리 - 영구 삭제

**페르소나:** 박지영 (직장인)

**상황:**
박지영은 월말이 되어 지난 달 완료된 프로젝트들을 정리하고자 한다. 휴지통에 쌓인 오래된 할일들을 영구 삭제한다.

#### Step 1: 휴지통 확인

**시간:** 금요일 오후

1. **행동**: 사이드바의 "휴지통" 메뉴 클릭
2. **화면**: 휴지통 페이지
   - 15개의 삭제된 할일 표시
   - 가장 오래된 항목: 30일 전 삭제
3. **행동**: 오래된 할일들 스크롤하며 확인
4. **판단**: "10월 프로젝트 기획" 등 더 이상 필요 없는 할일 확인

**소요 시간:** 30초

#### Step 2: 영구 삭제 시도

**시간:** 계속

1. **행동**: "10월 프로젝트 기획"의 "영구 삭제" 버튼 클릭
2. **화면**: 확인 다이얼로그 표시
   ```
   ┌─────────────────────────────────────┐
   │ ⚠️  경고                             │
   │                                     │
   │ 영구 삭제하시겠습니까?               │
   │ 이 작업은 되돌릴 수 없습니다.        │
   │                                     │
   │         [취소]  [영구 삭제]          │
   └─────────────────────────────────────┘
   ```
3. **감정**: 신중함 (경고 메시지 읽음)

**소요 시간:** 3초

#### Step 3: 영구 삭제 확인

**시간:** 계속

1. **행동**: "영구 삭제" 버튼 클릭
2. **시스템 처리**:
   - 데이터베이스에서 해당 레코드 완전 삭제 (DELETE)
   - 되돌릴 수 없음
3. **결과**:
   - 성공 토스트: "할일이 영구 삭제되었습니다"
   - 휴지통 목록에서 제거
   - 남은 항목: 14개
4. **행동**: 필요 없는 다른 할일들도 영구 삭제 반복
5. **감정**: 깔끔하게 정리된 느낌, 만족감

**소요 시간:** 5초 (항목당)

**전체 소요 시간:** 약 2분 (5개 항목 정리 시)

---

### 시나리오 5: 모바일 사용 - 외출 중 할일 추가

**페르소나:** 최현우 (프리랜서)

**상황:**
최현우는 카페에서 클라이언트와 미팅 중이다. 새로운 프로젝트 의뢰를 받고, 스마트폰으로 즉시 할일을 추가한다.

#### Step 1: 모바일 접속

**시간:** 오후 3시, 카페

1. **행동**: 스마트폰에서 yt-todolist 북마크 탭
2. **시스템**:
   - 반응형 레이아웃 자동 적용
   - 토큰 자동 갱신 (백그라운드)
3. **화면**: 모바일 최적화된 대시보드
   - 단일 컬럼 레이아웃
   - 하단 네비게이션 바
   - Floating Action Button (+)
4. **로딩**: 3G 환경에서도 1초 이내

**소요 시간:** 2초

#### Step 2: 빠른 할일 추가

**시간:** 계속

1. **행동**: 오른쪽 하단 FAB (+) 버튼 탭
2. **화면**: 풀스크린 할일 추가 모달
   - 모바일에 최적화된 입력 폼
   - 터치 친화적 버튼 크기
3. **행동**: 한 손으로 빠르게 입력
   - 제목: `ABC 회사 로고 디자인`
   - 내용: `초안 3개, 최종안 1개 제출`
   - 종료일: 캘린더 위젯에서 선택 → `2025-12-05`
4. **행동**: "저장" 버튼 탭
5. **결과**:
   - 햅틱 피드백 (진동)
   - 성공 토스트
   - 목록에 추가
6. **행동**: 클라이언트에게 "네, 일정 확인했습니다" 응답

**소요 시간:** 25초

**전체 소요 시간:** 약 30초

---

### 시나리오 6: 공휴일 확인 - 업무 계획 수립

**페르소나:** 박지영 (직장인)

**상황:**
박지영은 다음 달 프로젝트 일정을 계획하면서 공휴일을 확인하여 실제 근무일을 파악한다.

#### Step 1: 캘린더 뷰 접근

**시간:** 월초

1. **행동**: 상단 네비게이션에서 "캘린더" 탭 클릭 (P1 기능)
2. **화면**: 통합 캘린더 뷰
   - 개인 할일: 파란색
   - 공휴일: 빨간색
   - 주말: 회색 배경
3. **화면 예시**:
   ```
   12월 2025
   일  월  화  수  목  금  토
   1   2   3   4   5   6   7
   8   9  10  11  12  13  14
   15  16  17  18  19  20  21
   22  23  24 [크리스마스] 26 27  28
                  ^^^^
                 (빨간색)
   ```

**소요 시간:** 2초

#### Step 2: 공휴일 정보 확인

**시간:** 계속

1. **행동**: 크리스마스 (12월 25일) 클릭
2. **화면**: 상세 정보 팝오버
   ```
   ┌─────────────────────────┐
   │ 🎄 크리스마스            │
   │ 2025년 12월 25일 (목)   │
   │ 유형: 국경일            │
   │ 매년 반복: O            │
   │                         │
   │ ※ 수정/삭제 불가        │
   └─────────────────────────┘
   ```
3. **판단**: 목요일이 공휴일이므로 금요일 연차 사용하면 4일 연휴
4. **행동**: 해당 주에는 중요한 프로젝트 마감일 배치하지 않기로 결정

**소요 시간:** 10초

#### Step 3: 공휴일 고려한 일정 입력

**시간:** 계속

1. **행동**: "할일 추가" 버튼 클릭
2. **행동**: 정보 입력
   - 제목: `Q4 실적 보고서 작성`
   - 종료일: `2025-12-24 18:00` (크리스마스 전날)
3. **결과**: 공휴일 전날까지 마감으로 설정

**소요 시간:** 30초

**전체 소요 시간:** 약 1분

---

### 시나리오 7: 장기 프로젝트 관리

**페르소나:** 최현우 (프리랜서)

**상황:**
최현우는 2주간 진행되는 브랜딩 프로젝트를 관리한다. 시작일과 종료일을 명확히 설정하여 프로젝트 기간을 추적한다.

#### Step 1: 프로젝트 할일 추가

**시간:** 프로젝트 시작일

1. **행동**: "할일 추가" 버튼 클릭
2. **행동**: 상세 정보 입력
   - 제목: `DEF 회사 브랜딩 프로젝트`
   - 내용:
     ```
     Phase 1: 리서치 및 컨셉 (3일)
     Phase 2: 초안 디자인 (5일)
     Phase 3: 피드백 반영 (3일)
     Phase 4: 최종 납품 (1일)
     ```
   - 시작일: `2025-11-25 09:00`
   - 종료일: `2025-12-09 18:00` (2주 후)
3. **행동**: "저장" 버튼 클릭
4. **결과**: 할일 카드에 프로젝트 기간 명확히 표시

**소요 시간:** 2분

#### Step 2: 진행 중 확인

**시간:** 프로젝트 중간 (12월 2일)

1. **행동**: 할일 목록에서 해당 프로젝트 확인
2. **화면**: 할일 카드
   ```
   ┌─────────────────────────────────────┐
   │ DEF 회사 브랜딩 프로젝트             │
   │ Phase 1: 리서치 및 컨셉 (3일)       │
   │ ...                                 │
   │ 📅 2025-11-25 ~ 2025-12-09          │
   │ ⏰ D-7 (7일 남음)                   │
   │ [수정] [삭제]                        │
   └─────────────────────────────────────┘
   ```
3. **판단**: 일정대로 진행 중
4. **감정**: 진행 상황이 명확해서 안심

**소요 시간:** 5초

#### Step 3: 프로젝트 완료 및 기록

**시간:** 프로젝트 종료일 (12월 9일)

1. **행동**: 프로젝트 완료 후 삭제 버튼 클릭
2. **결과**: 휴지통으로 이동
3. **이유**:
   - 프로젝트 기록을 유지하고 싶음
   - 나중에 유사한 프로젝트 일정 참고용
4. **추후**: 필요 시 휴지통에서 과거 프로젝트 조회 가능

**소요 시간:** 3초

---

## 4. 예외 시나리오

### 예외 시나리오 1: 로그인 실패

**상황:** 비밀번호를 잘못 입력

#### 정상 흐름

1. 사용자가 이메일과 비밀번호 입력
2. "로그인" 버튼 클릭

#### 예외 발생

3. **시스템**: 비밀번호 검증 실패
4. **응답**: 401 Unauthorized
   ```json
   {
     "success": false,
     "error": {
       "code": "INVALID_CREDENTIALS",
       "message": "이메일 또는 비밀번호가 올바르지 않습니다."
     }
   }
   ```

#### 사용자 경험

5. **화면**:
   - 비밀번호 입력 필드 아래 빨간색 에러 메시지 표시
   - "이메일 또는 비밀번호가 올바르지 않습니다."
   - 비밀번호 필드 포커스
6. **행동**: 사용자가 비밀번호 재입력
7. **결과**: 정상 로그인

#### 보안 고려사항

- 이메일 또는 비밀번호 중 어느 것이 틀렸는지 명시하지 않음 (계정 열거 공격 방지)
- 5회 연속 실패 시 계정 잠금 (선택 기능)

---

### 예외 시나리오 2: 토큰 만료

**상황:** 장시간 방치 후 Access Token 만료

#### 정상 흐름

1. 사용자가 할일 추가 시도
2. API 호출: `POST /api/todos`

#### 예외 발생

3. **시스템**: Access Token 만료 확인
4. **응답**: 401 Unauthorized
   ```json
   {
     "success": false,
     "error": {
       "code": "TOKEN_EXPIRED",
       "message": "토큰이 만료되었습니다."
     }
   }
   ```

#### 자동 복구 (클라이언트)

5. **프론트엔드**:
   - Axios interceptor가 401 에러 감지
   - Refresh Token으로 토큰 갱신 시도
   - `POST /api/auth/refresh` 호출
6. **시스템**: 새 Access Token 발급
7. **프론트엔드**:
   - 새 토큰 저장
   - 원래 요청 재시도 (할일 추가)
8. **결과**: 사용자는 인지하지 못한 채 정상 동작

#### 사용자 경험

- **투명함**: 사용자는 토큰 갱신 과정을 알 필요 없음
- **추가 시간**: 약 100-200ms 지연 (눈에 띄지 않음)

#### Refresh Token도 만료된 경우

9. **시스템**: Refresh Token도 만료
10. **응답**: 401 Unauthorized
11. **프론트엔드**:
    - 토큰 삭제
    - 로그인 페이지로 리다이렉트
    - 토스트: "세션이 만료되었습니다. 다시 로그인해주세요."
12. **사용자**: 재로그인

---

### 예외 시나리오 3: 네트워크 오류

**상황:** 인터넷 연결 끊김

#### 정상 흐름

1. 사용자가 할일 추가 시도
2. "저장" 버튼 클릭

#### 예외 발생

3. **시스템**: 네트워크 요청 실패 (timeout 또는 연결 오류)
4. **프론트엔드**:
   - Axios가 네트워크 에러 감지
   - `Network Error` 또는 `timeout of 10000ms exceeded`

#### 사용자 경험

5. **화면**:
   - 에러 토스트: "네트워크 연결을 확인해주세요."
   - 로딩 스피너 제거
   - 모달은 열린 상태 유지 (입력 데이터 보존)
6. **행동**:
   - 사용자가 인터넷 연결 확인
   - "저장" 버튼 다시 클릭
7. **결과**:
   - 연결 복구 후 정상 저장
   - 입력 데이터 손실 없음

#### 개선 사항 (P2)

- 오프라인 감지: `window.addEventListener('offline', ...)`
- 오프라인 배너 표시
- 연결 복구 시 자동 재시도

---

### 예외 시나리오 4: 잘못된 날짜 입력

**상황:** 시작일이 종료일보다 나중

#### 정상 흐름

1. 사용자가 할일 추가 시도
2. 정보 입력:
   - 제목: `프로젝트 A`
   - 시작일: `2025-12-01`
   - 종료일: `2025-11-30` (시작일보다 이전!)

#### 클라이언트 측 검증

3. **프론트엔드**:
   - React Hook Form이 검증 실행
   - 규칙: `startDate <= endDate`
4. **화면**:
   - 종료일 필드 아래 빨간색 에러 메시지
   - "종료일은 시작일 이후여야 합니다."
   - "저장" 버튼 비활성화
5. **행동**: 사용자가 날짜 수정
6. **결과**: 에러 메시지 사라지고 "저장" 버튼 활성화

#### 서버 측 재검증 (방어적 프로그래밍)

만약 클라이언트 검증을 우회하여 잘못된 데이터가 전송된 경우:

7. **시스템**: express-validator가 검증 실행
8. **응답**: 400 Bad Request
   ```json
   {
     "success": false,
     "error": {
       "code": "VALIDATION_ERROR",
       "message": "시작일은 종료일보다 이전이어야 합니다.",
       "field": "endDate"
     }
   }
   ```
9. **화면**: 에러 토스트 표시

---

### 예외 시나리오 5: 다른 사용자의 할일 접근 시도

**상황:** 권한 없는 할일 수정 시도 (URL 조작 등)

#### 비정상 흐름

1. **공격자**: URL 직접 입력으로 다른 사용자의 할일 수정 시도
   - `PUT /api/todos/550e8400-e29b-41d4-a716-446655440000`
   - Authorization 헤더: 공격자의 토큰

#### 서버 측 권한 검증

2. **시스템**:
   - JWT에서 사용자 ID 추출 (예: user_id = 'ATTACKER_ID')
   - 할일 조회: `SELECT * FROM todos WHERE id = '550e8400...'`
   - 할일의 user_id와 비교
   - `todo.user_id` (VICTIM_ID) ≠ `jwt.user_id` (ATTACKER_ID)
   - 권한 없음 판정

3. **응답**: 403 Forbidden
   ```json
   {
     "success": false,
     "error": {
       "code": "FORBIDDEN",
       "message": "이 작업을 수행할 권한이 없습니다."
     }
   }
   ```

#### 사용자 경험

4. **화면**:
   - 에러 토스트: "권한이 없습니다."
   - 메인 대시보드로 리다이렉트

#### 보안 로그

5. **시스템**:
   - 의심스러운 접근 시도 로그 기록
   - 필요 시 관리자 알림

---

### 예외 시나리오 6: 공휴일 삭제 시도

**상황:** 사용자가 공휴일을 삭제하려고 시도

#### 비정상 흐름

1. **사용자**: (UI 조작 또는 API 직접 호출로) 공휴일 삭제 시도
   - `DELETE /api/holidays/550e8400-e29b-41d4-a716-446655440000`

#### 서버 측 검증

2. **시스템**:
   - 공휴일은 삭제 불가 (BR-011)
   - 삭제 요청 거부

3. **응답**: 403 Forbidden
   ```json
   {
     "success": false,
     "error": {
       "code": "CANNOT_DELETE_HOLIDAY",
       "message": "공휴일은 삭제할 수 없습니다."
     }
   }
   ```

#### UI 설계로 예방

4. **프론트엔드**:
   - 공휴일 항목에는 삭제/수정 버튼을 아예 표시하지 않음
   - 읽기 전용 뱃지 표시: "공휴일"

---

## 5. 사용자 스토리

### Epic 1: 사용자 인증

#### US-001: 회원가입
```
As a 새로운 사용자
I want to 이메일과 비밀번호로 회원가입하고 싶다
So that 나만의 할일 목록을 관리할 수 있다
```

**인수 조건:**
- [ ] 이메일 형식 검증
- [ ] 비밀번호 강도 검증 (8자 이상, 복잡도)
- [ ] 이메일 중복 확인
- [ ] 성공 시 자동 로그인 또는 로그인 페이지 이동

---

#### US-002: 로그인
```
As a 가입된 사용자
I want to 이메일과 비밀번호로 로그인하고 싶다
So that 내 할일 목록에 접근할 수 있다
```

**인수 조건:**
- [ ] 유효한 자격증명으로 로그인 성공
- [ ] Access Token과 Refresh Token 발급
- [ ] 잘못된 자격증명 시 에러 메시지
- [ ] 로그인 후 메인 대시보드로 리다이렉트

---

#### US-003: 자동 토큰 갱신
```
As a 로그인한 사용자
I want to 토큰이 자동으로 갱신되길 원한다
So that 계속 작업 중에 로그아웃되지 않는다
```

**인수 조건:**
- [ ] Access Token 만료 시 Refresh Token으로 자동 갱신
- [ ] 사용자는 갱신 과정을 인지하지 못함
- [ ] Refresh Token 만료 시에만 재로그인 요구

---

### Epic 2: 할일 관리

#### US-004: 할일 목록 조회
```
As a 로그인한 사용자
I want to 내 할일 목록을 조회하고 싶다
So that 오늘 해야 할 일을 확인할 수 있다
```

**인수 조건:**
- [ ] 본인의 활성 상태 할일만 표시
- [ ] 종료일 순으로 정렬
- [ ] 공휴일 정보 함께 표시
- [ ] 200ms 이내 응답

---

#### US-005: 할일 추가
```
As a 로그인한 사용자
I want to 새로운 할일을 추가하고 싶다
So that 잊지 않고 작업을 완료할 수 있다
```

**인수 조건:**
- [ ] 제목 필수 입력
- [ ] 종료일 필수 입력
- [ ] 시작일은 종료일 이전이어야 함
- [ ] 성공 시 목록에 즉시 반영
- [ ] 모바일에서도 빠른 입력 가능

---

#### US-006: 할일 수정
```
As a 로그인한 사용자
I want to 기존 할일을 수정하고 싶다
So that 변경된 일정을 반영할 수 있다
```

**인수 조건:**
- [ ] 본인의 할일만 수정 가능
- [ ] 모든 필드 수정 가능
- [ ] 날짜 유효성 재검증
- [ ] 수정일시 자동 갱신

---

#### US-007: 할일 삭제
```
As a 로그인한 사용자
I want to 완료된 할일을 삭제하고 싶다
So that 목록을 깔끔하게 유지할 수 있다
```

**인수 조건:**
- [ ] 즉시 삭제되지 않고 휴지통으로 이동
- [ ] 삭제일시 자동 기록
- [ ] 할일 목록에서 즉시 제거
- [ ] 휴지통에서 복구 가능

---

### Epic 3: 휴지통 관리

#### US-008: 휴지통 조회
```
As a 로그인한 사용자
I want to 삭제한 할일을 조회하고 싶다
So that 필요 시 복구할 수 있다
```

**인수 조건:**
- [ ] 본인의 휴지통 항목만 표시
- [ ] 삭제일시 순으로 정렬
- [ ] 각 항목에 삭제일시 표시

---

#### US-009: 할일 복원
```
As a 로그인한 사용자
I want to 휴지통의 할일을 복원하고 싶다
So that 실수로 삭제한 항목을 되돌릴 수 있다
```

**인수 조건:**
- [ ] 원클릭 복원 (확인 없이)
- [ ] 활성 상태로 즉시 복원
- [ ] 할일 목록에 다시 표시
- [ ] 휴지통에서 제거

---

#### US-010: 할일 영구 삭제
```
As a 로그인한 사용자
I want to 휴지통의 할일을 영구 삭제하고 싶다
So that 더 이상 필요 없는 데이터를 정리할 수 있다
```

**인수 조건:**
- [ ] 확인 다이얼로그 표시 (경고 메시지)
- [ ] 확인 후 데이터베이스에서 완전 삭제
- [ ] 복구 불가능
- [ ] 휴지통 목록에서 제거

---

### Epic 4: 공휴일 통합

#### US-011: 공휴일 조회
```
As a 로그인한 사용자
I want to 공휴일을 할일과 함께 조회하고 싶다
So that 업무 일정을 효율적으로 계획할 수 있다
```

**인수 조건:**
- [ ] 할일 목록에 공휴일 통합 표시
- [ ] 공휴일은 시각적으로 구분됨 (색상, 아이콘)
- [ ] 공휴일은 수정/삭제 불가
- [ ] 연도별 공휴일 정보 제공

---

## 부록

### A. 시나리오 요약 표

| 시나리오 | 페르소나 | 주요 기능 | 소요 시간 | 우선순위 |
|----------|----------|-----------|-----------|----------|
| 1. 첫 사용자 | 김민수 | 회원가입, 로그인, 할일 추가 | 2분 | P0 |
| 2. 일상적 사용 | 박지영 | 할일 조회, 추가, 수정, 삭제 | 5분/일 | P0 |
| 3. 실수 복구 | 김민수 | 휴지통 복원 | 10초 | P0 |
| 4. 휴지통 정리 | 박지영 | 영구 삭제 | 2분 | P0 |
| 5. 모바일 사용 | 최현우 | 반응형 UI, 빠른 입력 | 30초 | P1 |
| 6. 공휴일 확인 | 박지영 | 공휴일 조회, 캘린더 | 1분 | P1 |
| 7. 장기 프로젝트 | 최현우 | 시작일/종료일 관리 | 2분 | P0 |

### B. 화면 플로우 다이어그램

```
[로그인 화면]
    │
    ├─[회원가입]──► [회원가입 폼] ──► [로그인 화면]
    │
    └─[로그인 성공]
         │
         ▼
    [메인 대시보드]
         │
         ├─[할일 추가]──► [할일 추가 모달] ──► [메인 대시보드]
         │
         ├─[할일 수정]──► [할일 수정 모달] ──► [메인 대시보드]
         │
         ├─[할일 삭제]──► [휴지통으로 이동] ──► [메인 대시보드]
         │
         ├─[휴지통]
         │    │
         │    ├─[복원]──► [메인 대시보드]
         │    │
         │    └─[영구 삭제]──► [확인 다이얼로그] ──► [휴지통]
         │
         ├─[캘린더]──► [통합 캘린더 뷰]
         │
         └─[로그아웃]──► [로그인 화면]
```

### C. 관련 문서

- [도메인 정의서](./1-domain-definition.md)
- [PRD 입력 템플릿](./2-prd-input-template.md)
- [PRD](./3-prd.md)

---

**문서 버전:** 1.0
**최초 작성일:** 2025-11-25
**최종 수정일:** 2025-11-25
**작성자:** 개발팀
